{"version":3,"file":"1-timer.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst startBtn = document.querySelector(\"button[data-start]\");\nconst dataInput = document.querySelector(\"#datetime-picker\");\nconst dataDays = document.querySelector(\"span[data-days]\");\nconst dataHours = document.querySelector(\"span[data-hours]\");\nconst dataMinutes = document.querySelector(\"span[data-minutes]\");\nconst dataSeconds = document.querySelector(\"span[data-seconds]\");\n\nlet userSelectedTime = 0;\nlet timeoutId = null;\nstartBtn.disabled = true;\n\n// На промисах\n\n// const options = {\n//   enableTime: true,\n//   time_24hr: true,\n//   defaultDate: new Date(),\n//   minuteIncrement: 1,\n//     onClose(selectedDates) {\n//         const pickedDate = selectedDates[0];\n//         console.log(selectedDates[0]);\n//         if (!pickedDate) {\n//             return;\n//         }\n//         const pickedTime = pickedDate.getTime();\n//         const now = Date.now();\n//         if (pickedTime <= now) {\n//             iziToast.show({\n//                 message: \"Please choose a date in the future\",\n//                 color: \"red\",\n//                 position: \"topRight\",\n//             });\n//             startBtn.disabled = true;\n//             userSelectedTime = 0;\n//             return;\n//         }\n//         userSelectedTime = pickedTime;\n//         startBtn.disabled = false;\n//     },\n// };\n\n// flatpickr(\"#datetime-picker\", options);\n\n// function onStart() {\n//     if (!userSelectedTime) {\n//         return;\n//     }\n//     startBtn.disabled = true;\n//     dataInput.disabled = true;\n//     if (timeoutId !== null) {\n//         clearTimeout(timeoutId);\n//         timeoutId = null;\n//     }\n//     runCountdown(userSelectedTime)\n//         .then(() => {\n//             dataInput.disabled = false;\n//             startBtn.disabled = true;\n//             userSelectedTime = 0;\n//         })\n//         .catch((error) => {\n//             console.error(\"Timer Error\", error);\n//             dataInput.disabled = false;\n//             startBtn.disabled = true;\n            \n//         })\n// };\n\n// function runCountdown(targetTime) {\n//     return new Promise((resolve, reject) => {\n//         function next() {\n//             try {\n//                 const now = Date.now();\n//                 const difference = targetTime - now;\n//                 if (difference <= 0) {\n//                     const zeroTime = convertMs(0);\n//                     const formattedZero = formatTime(zeroTime);\n//                     updateClock(formattedZero);\n//                     timeoutId = null;\n//                     resolve();\n//                     return;\n//                 };\n//                 const timeObj = convertMs(difference);\n//                 const formatted = formatTime(timeObj);\n//                 updateClock(formatted);\n\n//                 const reminder = difference % 1000;\n//                 let delay;\n//                 if (reminder > 0) {\n//                     delay = reminder;\n//                 } else {\n//                     delay = 1000;\n//                 }\n//                 timeoutId = setTimeout(next, delay);\n//             } catch (err) {\n//                 reject(err);\n//             }\n//         }\n//         next();\n//     })\n// }\n\n// function convertMs(ms) {\n//   // Number of milliseconds per unit of time\n//   const second = 1000;\n//   const minute = second * 60;\n//   const hour = minute * 60;\n//   const day = hour * 24;\n\n//   // Remaining days\n//   const days = Math.floor(ms / day);\n//   // Remaining hours\n//   const hours = Math.floor((ms % day) / hour);\n//   // Remaining minutes\n//   const minutes = Math.floor(((ms % day) % hour) / minute);\n//   // Remaining seconds\n//   const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n//   return { days, hours, minutes, seconds };\n// }\n\n// function formatTime({ days, hours, minutes, seconds }) {\n//   if (days < 10) {\n//     days = '0' + days;\n//   }\n//   if (hours < 10) {\n//     hours = '0' + hours;\n//   }\n//   if (minutes < 10) {\n//     minutes = '0' + minutes;\n//   }\n//   if (seconds < 10) {\n//     seconds = '0' + seconds;\n//   }\n\n//   return { days, hours, minutes, seconds };\n// }\n\n// function updateClock({ days, hours, minutes, seconds }) {\n//   dataDays.textContent    = days;\n//   dataHours.textContent   = hours;\n//   dataMinutes.textContent = minutes;\n//   dataSeconds.textContent = seconds;\n// }\n\n// startBtn.addEventListener('click', onStart);\n\n\nconst options = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n    onClose(selectedDates) {\n        const pickedDate = selectedDates[0];\n        console.log(selectedDates[0]);\n        if (!pickedDate) {\n            return;\n        }\n        const pickedTime = pickedDate.getTime();\n        const now = Date.now();\n        if (pickedTime <= now) {\n            iziToast.show({\n                message: \"Please choose a date in the future\",\n                color: \"red\",\n                position: \"topRight\",\n            });\n            startBtn.disabled = true;\n            userSelectedTime = 0;\n            return;\n        }\n        userSelectedTime = pickedTime;\n        startBtn.disabled = false;\n    },\n};\n\nflatpickr(\"#datetime-picker\", options);\n\nfunction onStart() { \n    if (!userSelectedTime) {\n        return;\n    }\n    startBtn.disabled = true;\n    dataInput.disabled = true;\n    if (timeoutId !== null) { \n        clearInterval(timeoutId);\n    };\n    timeoutId = setInterval(() => {\n        const now = Date.now();\n        const difference = userSelectedTime - now;\n        if (difference <= 0) {\n            clearInterval(timeoutId);\n            timeoutId = null;\n            updateClock(formatTime(convertMs(0)));\n            startBtn.disabled = true;\n            dataInput.disabled = false;\n            userSelectedTime = 0;\n            return;\n        };\n        const timeObj = convertMs(difference);\n        const formatted = formatTime(timeObj);\n        updateClock(formatted);\n    }, 1000);\n};\n\nfunction convertMs(ms) {\n  // Number of milliseconds per unit of time\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  // Remaining days\n  const days = Math.floor(ms / day);\n  // Remaining hours\n  const hours = Math.floor((ms % day) / hour);\n  // Remaining minutes\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  // Remaining seconds\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n\nfunction formatTime({ days, hours, minutes, seconds }) {\n  if (days < 10) {\n    days = '0' + days;\n  }\n  if (hours < 10) {\n    hours = '0' + hours;\n  }\n  if (minutes < 10) {\n    minutes = '0' + minutes;\n  }\n  if (seconds < 10) {\n    seconds = '0' + seconds;\n  }\n\n  return { days, hours, minutes, seconds };\n}\n\nfunction updateClock({ days, hours, minutes, seconds }) {\n  dataDays.textContent    = days;\n  dataHours.textContent   = hours;\n  dataMinutes.textContent = minutes;\n  dataSeconds.textContent = seconds;\n}\n\nstartBtn.addEventListener('click', onStart);"],"names":["startBtn","dataInput","dataDays","dataHours","dataMinutes","dataSeconds","userSelectedTime","timeoutId","options","selectedDates","pickedDate","pickedTime","now","iziToast","flatpickr","onStart","difference","updateClock","formatTime","convertMs","timeObj","formatted","ms","days","hours","minutes","seconds"],"mappings":"2GAMA,MAAMA,EAAW,SAAS,cAAc,oBAAoB,EACtDC,EAAY,SAAS,cAAc,kBAAkB,EACrDC,EAAW,SAAS,cAAc,iBAAiB,EACnDC,EAAY,SAAS,cAAc,kBAAkB,EACrDC,EAAc,SAAS,cAAc,oBAAoB,EACzDC,EAAc,SAAS,cAAc,oBAAoB,EAE/D,IAAIC,EAAmB,EACnBC,EAAY,KAChBP,EAAS,SAAW,GA0IpB,MAAMQ,EAAU,CACd,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACf,QAAQC,EAAe,CACnB,MAAMC,EAAaD,EAAc,CAAC,EAElC,GADA,QAAQ,IAAIA,EAAc,CAAC,CAAC,EACxB,CAACC,EACD,OAEJ,MAAMC,EAAaD,EAAW,UACxBE,EAAM,KAAK,MACjB,GAAID,GAAcC,EAAK,CACnBC,EAAS,KAAK,CACV,QAAS,qCACT,MAAO,MACP,SAAU,UAC1B,CAAa,EACDb,EAAS,SAAW,GACpBM,EAAmB,EACnB,MACH,CACDA,EAAmBK,EACnBX,EAAS,SAAW,EACvB,CACL,EAEAc,EAAU,mBAAoBN,CAAO,EAErC,SAASO,GAAU,CACVT,IAGLN,EAAS,SAAW,GACpBC,EAAU,SAAW,GACjBM,IAAc,MACd,cAAcA,CAAS,EAE3BA,EAAY,YAAY,IAAM,CAC1B,MAAMK,EAAM,KAAK,MACXI,EAAaV,EAAmBM,EACtC,GAAII,GAAc,EAAG,CACjB,cAAcT,CAAS,EACvBA,EAAY,KACZU,EAAYC,EAAWC,EAAU,CAAC,CAAC,CAAC,EACpCnB,EAAS,SAAW,GACpBC,EAAU,SAAW,GACrBK,EAAmB,EACnB,MAEZ,CAAQ,MAAMc,EAAUD,EAAUH,CAAU,EAC9BK,EAAYH,EAAWE,CAAO,EACpCH,EAAYI,CAAS,CACxB,EAAE,GAAI,EACX,CAEA,SAASF,EAAUG,EAAI,CAQrB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAE1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EAEpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EAEjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CAEA,SAASR,EAAW,CAAE,KAAAK,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,EAAI,CACrD,OAAIH,EAAO,KACTA,EAAO,IAAMA,GAEXC,EAAQ,KACVA,EAAQ,IAAMA,GAEZC,EAAU,KACZA,EAAU,IAAMA,GAEdC,EAAU,KACZA,EAAU,IAAMA,GAGX,CAAE,KAAAH,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CAEA,SAAST,EAAY,CAAE,KAAAM,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,EAAI,CACtDxB,EAAS,YAAiBqB,EAC1BpB,EAAU,YAAgBqB,EAC1BpB,EAAY,YAAcqB,EAC1BpB,EAAY,YAAcqB,CAC5B,CAEA1B,EAAS,iBAAiB,QAASe,CAAO"}